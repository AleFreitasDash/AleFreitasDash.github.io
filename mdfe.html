<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MDFe</title>
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="./images/favicon.png">
    <link href="./vendor/bootstrap-select/dist/css/bootstrap-select.min.css" rel="stylesheet">
    <link href="./css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="./vendor/chartist/css/chartist.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/levenshtein/1.0.5/levenshtein.js"></script>

    <script type="module" src="./js/inactivity-logout.js"></script>
    <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-database.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-analytics.js";
    
    const firebaseConfig = {
        apiKey: "AIzaSyCjkrAB_X57m8wOLqzWxS6CBB-yc3onHNQ",
        authDomain: "motorista-2b1dd.firebaseapp.com",
        databaseURL: "https://motorista-2b1dd-default-rtdb.firebaseio.com",
        projectId: "motorista-2b1dd",
        storageBucket: "motorista-2b1dd.appspot.com",
        messagingSenderId: "46949027696",
        appId: "1:46949027696:web:66dc7d505fc9c766f8c9b5",
        measurementId: "G-2JC1729XZK"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);
    const database = getDatabase(app);

    onAuthStateChanged(auth, (user) => {
        if (user) {
            // Verifica se o usuário tem um displayName, se não, usa um fallback
            const displayName = user.displayName || "Usuário";
            document.getElementById('user-name1').innerText = displayName;

            // Carregar notificações do banco de dados do Firebase
            const userId = user.uid;
            const notificationsRef = ref(database, 'notifications/' + userId);
            onValue(notificationsRef, (snapshot) => {
                const notifications = snapshot.val();
                const notificationContainer = document.getElementById('notification-container');
                notificationContainer.innerHTML = '';
                if (notifications) {
                    for (let key in notifications) {
                        const notification = notifications[key];
                        const li = document.createElement('li');
                        li.innerHTML = `<strong>${notification.title}</strong>: ${notification.content}`;
                        notificationContainer.appendChild(li);
                    }
                }
            });
        } else {
            window.location.href = 'page-login.html';
        }
    });

    document.getElementById('logout').addEventListener('click', () => {
        signOut(auth).then(() => {
            window.location.href = 'page-login.html';
        }).catch((error) => {
            console.error('Erro ao realizar logout:', error);
        });
    });
</script>

</head>

<body>
    <!-- Preloader start -->
    <div id="preloader">
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>
    <!-- Preloader end -->

    <!-- Main wrapper start -->
    <div id="main-wrapper">

        <!-- Nav header start -->
        <div class="nav-header">
            <a href="index.html" class="brand-logo">
                <img class="logo-compact logo-abbr" src="./images/logo-text.png" alt="">
                <img class="brand-title" src="./images/logo-text.png" alt="">
            </a>

            <div class="nav-control">
                <div class="hamburger">
                    <span class="line"></span><span class="line"></span><span class="line"></span>
                </div>
            </div>
        </div>
        <!-- Nav header end -->

        <!--**********************************
            Header start
        ***********************************-->
        <div class="header">
            <div class="header-content">
                <nav class="navbar navbar-expand">
                    <div class="collapse navbar-collapse justify-content-between">
                        <div class="header-left">
                        </div>

                        <ul class="navbar-nav header-right">
                            <li class="nav-item dropdown notification_dropdown">
                                <a class="nav-link  ai-icon warning" href="#" role="button" data-toggle="dropdown">
                                    <svg width="24" height="24" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.75 14.8385V12.0463C21.7471 9.88552 20.9385 7.80353 19.4821 6.20735C18.0258 4.61116 16.0264 3.61555 13.875 3.41516V1.625C13.875 1.39294 13.7828 1.17038 13.6187 1.00628C13.4546 0.842187 13.2321 0.75 13 0.75C12.7679 0.75 12.5454 0.842187 12.3813 1.00628C12.2172 1.17038 12.125 1.39294 12.125 1.625V3.41534C9.97361 3.61572 7.97429 4.61131 6.51794 6.20746C5.06159 7.80361 4.25291 9.88555 4.25 12.0463V14.8383C3.26257 15.0412 2.37529 15.5784 1.73774 16.3593C1.10019 17.1401 0.751339 18.1169 0.75 19.125C0.750764 19.821 1.02757 20.4882 1.51969 20.9803C2.01181 21.4724 2.67904 21.7492 3.375 21.75H8.71346C8.91521 22.738 9.45205 23.6259 10.2331 24.2636C11.0142 24.9013 11.9916 25.2497 13 25.2497C14.0084 25.2497 14.9858 24.9013 15.7669 24.2636C16.548 23.6259 17.0848 22.738 17.2865 21.75H22.625C23.321 21.7492 23.9882 21.4724 24.4803 20.9803C24.9724 20.4882 25.2492 19.821 25.25 19.125C25.2486 18.117 24.8998 17.1402 24.2622 16.3594C23.6247 15.5786 22.7374 15.0414 21.75 14.8385ZM6 12.0463C6.00232 10.2113 6.73226 8.45223 8.02974 7.15474C9.32723 5.85726 11.0863 5.12732 12.9212 5.125H13.0788C14.9137 5.12732 16.6728 5.85726 17.9703 7.15474C19.2677 8.45223 19.9977 10.2113 20 12.0463V14.75H6V12.0463ZM13 23.5C12.4589 23.4983 11.9316 23.3292 11.4905 23.0159C11.0493 22.7026 10.716 22.2604 10.5363 21.75H15.4637C15.284 22.2604 14.9507 22.7026 14.5095 23.0159C14.0684 23.3292 13.5411 23.4983 13 23.5ZM22.625 20H3.375C3.14298 19.9999 2.9205 19.9076 2.75644 19.7436C2.59237 19.5795 2.50014 19.357 2.5 19.125C2.50076 18.429 2.77757 17.7618 3.26969 17.2697C3.76181 16.7776 4.42904 16.5008 5.125 16.5H20.875C21.571 16.5008 22.2382 16.7776 22.7303 17.2697C23.2224 17.7618 23.4992 18.429 23.5 19.125C23.4999 19.357 23.4076 19.5795 23.2436 19.7436C23.0795 19.9076 22.857 19.9999 22.625 20Z" fill="#000"/></svg>
                                    <div class="pulse-css"></div>
                                </a>
<div class="dropdown-menu dropdown-menu-right">
    <div id="DZ_W_Notification1" class="widget-media dz-scroll p-3" style="height:380px;">
        <ul id="notification-container" class="timeline">
        </ul>
    </div>
</div>

                            </li>
                            <li class="nav-item dropdown header-profile">
                                <a class="nav-link" href="#" role="button" data-toggle="dropdown">
                                    <div class="header-info">
                                        <span><strong id="user-name1">...</strong></span>
                                    </div>
                                    <img src="images/profile/pic1.jpg" width="20" alt=""/>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a href="./app-profile.html" class="dropdown-item ai-icon">
                                        <svg id="icon-user1" xmlns="http://www.w3.org/2000/svg" class="text-primary" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                                        <span class="ml-2">Meus Dados</span>
                                    </a>
                                    <a href="./avisos.html" class="dropdown-item ai-icon">
                                        <svg id="icon-inbox" xmlns="http://www.w3.org/2000/svg" class="text-success" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                                        <span class="ml-2">Avisos</span>
                                    </a>
                                    <a href="#" id="logout" class="dropdown-item ai-icon">
                                        <svg id="icon-logout" xmlns="http://www.w3.org/2000/svg" class="text-danger" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                                        <span class="ml-2">Sair</span>
                                    </a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
        <!--**********************************
            Header end
        ***********************************-->

        <!-- Sidebar start -->
        <div class="deznav">
            <div class="deznav-scroll">
                <ul class="metismenu" id="menu">
                    <li><a class="ai-icon" href="index.html" aria-expanded="false">
                        <i class="flaticon-381-home-1"></i>
                        <span class="nav-text">Inicio</span>
                    </a>
                    </li>
                    <li><a class="has-arrow ai-icon" href="javascript:void()" aria-expanded="false">
                        <i class="flaticon-381-file-2"></i>
                        <span class="nav-text">Cte</span>
                    </a>
                        <ul aria-expanded="false">
                            <li><a href="./cte.html">Consulta de Conhecimento</a></li>
                        </ul>
                    </li>
                    <li><a class="has-arrow ai-icon" href="javascript:void()" aria-expanded="false">
                        <i class="flaticon-381-folder-6"></i>
                        <span class="nav-text">Compras</span>
                    </a>
                        <ul aria-expanded="false">
                            <li><a href="./compras_acompanhamento.html">Acompanhamento de pedidos</a></li>
                            <li><a href="./pedidos_de_compra.html">Cotações / Pedidos de Compra</a></li>
                        </ul>
                    </li>
                    <li><a class="has-arrow ai-icon" href="javascript:void()" aria-expanded="false">
                        <i class="flaticon-381-calculator-1"></i>
                        <span class="nav-text">Financeiro</span>
                    </a>
                        <ul aria-expanded="false">
                            <li><a href="./financeiro.html">Segunda via de boleto / Link de Pagamento</a></li>
                        </ul>
                    </li>
                    <li><a class="has-arrow ai-icon" href="javascript:void()" aria-expanded="false">
                        <i class="flaticon-381-print-1"></i>
                        <span class="nav-text">Impressão Virtual</span>
                    </a>
                        <ul aria-expanded="false">
                            <li><a href="./impressao.html">Download de documentos</a></li>
                        </ul>
                    </li>
                    <li><a class="has-arrow" href="javascript:void()" aria-expanded="false">
                        <i class="flaticon-381-search-3"></i>
                        <span class="nav-text">MDFe</span>
                    </a>
                        <ul aria-expanded="false">
                            <li><a href="./mdfe.html">Consulta de manifestos de documentos fiscais eletrônicos</a></li>
                        </ul>
                    </li>
                    <li><a class="has-arrow ai-icon" href="javascript:void()" aria-expanded="false">
                        <i class="flaticon-381-file-2"></i>
                        <span class="nav-text">NFe</span>
                    </a>
                        <ul aria-expanded="false">
                            <li><a href="./nfe.html">Consulta de notas fiscais eletrônicas</a></li>
                        </ul>
                    </li>
                    <li><a class="has-arrow ai-icon" href="javascript:void()" aria-expanded="false">
                        <i class="flaticon-381-user-9"></i>
                        <span class="nav-text">Terceiros</span>
                    </a>
                        <ul aria-expanded="false">
                            <li><a href="./terceiros_documentos.html">Documentos</a></li>
                            <li><a href="./terceiros_irf.html">Informe de Rendimentos do Fornecedor</a></li>
                        </ul>
                    </li>
                    <li><a class="has-arrow ai-icon" href="javascript:void()" aria-expanded="false">
                        <i class="flaticon-381-id-card-5"></i>
                        <span class="nav-text">Transportadores</span>
                    </a>
                        <ul aria-expanded="false">
                            <li><a href="./t_alteracao_frota.html">Alteração de frotas</a></li>
                            <li><a href="./t_disponibilidade.html">Disponibilidade de frota</a></li>
                            <li><a href="./t_relatorios.html">Relatórios</a></li>
                        </ul>
                    </li>
                </ul>
                <div class="add-menu-sidebar">
                    <img src="images/icon1.png" alt=""/>
                    <p>Conversar com a Soli</p>
                    <a href="javascript:void(0);" class="btn btn-primary btn-block light">Whatsapp</a>
                </div>
                <div class="copyright">
                    <p><strong>Alexandre Freitas</strong> © 2024 All Rights Reserved</p>
                </div>
            </div>
        </div>
        <!-- Sidebar end -->

        <!-- Content body start -->
        <div class="content-body">
            <div class="container-fluid">
            <div class="row page-titles mx-0">
                    <div class="col-sm-6 p-md-0">
                        <div class="welcome-text">
                            <span>{NOME DA EMPRESA}</span>
                        </div>
                    </div>
                    <div class="col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="javascript:void(0)">MDFe</a></li>
                            <li class="breadcrumb-item active"><a href="javascript:void(0)">Consulta de Manifestos</a></li>
                        </ol>
                    </div>
                </div>
                <!-- Filtro e Tabela -->
                <div class="row">
                    <div class="col-lg-12">
                        <form id="filter-form" class="form-inline mb-3">
                            <label for="de" class="mr-2">De:</label>
                            <input type="date" class="form-control-sm mb-3" id="de">
                            <label for="ate" class="mr-2">Até:</label>
                            <input type="date" class="form-control-sm mb-3" id="ate">
                        </form>
                        <form id="filter-form2" class="form-inline mb-3">
                            <label for="nro" class="mr-2">Planilha:</label>
                            <input type="text" class="form-control-sm mb-3" id="nro">
                            <label for="nfe" class="mr-2">NF:</label>
                            <input type="text" class="form-control-sm mb-3" id="nfe">
                            <label for="chave" class="mr-2">Chave:</label>
                            <input type="text" class="form-control-sm mb-3" id="chave">
                        </form>
                        <form id="filter-form3" class="form-inline mb-3">
                            <button type="submit" class="btn btn-primary">Pesquisar</button>
                        </form>
				</div>
                </div>
                
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Consulta de Manifestos</h4>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-responsive-md" id="result-table">
                                        <thead>
                                            <tr>
                                                <th style="width:50px;">
                                                    <div class="custom-control custom-checkbox checkbox-success check-lg mr-3">
                                                        <input type="checkbox" class="custom-control-input" id="checkAll" required="">
                                                        <label class="custom-control-label" for="checkAll"></label>
                                                    </div>
                                                </th>
                                                <th><strong>PLANILHA</strong></th>
                                                <th><strong>NFE</strong></th>
                                                <th><strong>EMISSÃO</strong></th>
                                                <th><strong>CNPJ</strong></th>
                                                <th><strong>CHAVE DE ACESSO</strong></th>
                                                <th><strong>STATUS</strong></th>
                                                <th><strong>XML</strong></th>
                                                <th><strong>PDF</strong></th>
                                            </tr>
                                        </thead>
                                        <tbody id="table-body">
                                            <!-- Mais linhas conforme necessário -->
                                        </tbody>
                                    </table>
                                    
                                </div>
                                <button class="btn btn-warning">Atualizar Listagem</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Fim da Tabela -->

            </div>
        </div>
        <!-- Content body end -->

    </div>
    <!-- Main wrapper end -->

    <!-- Required vendors -->
    <script src="./vendor/global/global.min.js"></script>
    <script src="./vendor/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <script src="./vendor/chart.js/Chart.bundle.min.js"></script>
    <script src="./js/custom.min.js"></script>
    <script src="./js/deznav-init.js"></script>
    <!-- Apex Chart -->
    <script src="./vendor/apexchart/apexchart.js"></script>
<script src="./vendor/nouislider/nouislider.min.js"></script>
<script src="./vendor/wnumb/wNumb.js"></script>
<script src="./js/plugins-init/nouislider-init.js"></script>
<script src="./js/plugins-init/widgets-script-init.js"></script>
<script src="./vendor/peity/jquery.peity.min.js"></script>
<script src="./js/plugins-init/piety-init.js"></script>
<script src="./vendor/chart.js/Chart.bundle.min.js"></script>
    <script>
        // Dados da planilha simulados
        const data = [
            { planilha: "4019067", nfe: "12345", emissao: "2024-07-19", cnpj: "NOME EMPRESA 1<br>CNPJ 1", chave: "CHAVE COM 44 NUMEROS", status: "STATUS" },
            { planilha: "4019068", nfe: "67890", emissao: "2024-07-20", cnpj: "NOME EMPRESA 2<br>CNPJ 3", chave: "CHAVE COM 44 NUMEROS", status: "STATUS" }
        ];

        function renderTable(filteredData) {
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML = "";

            filteredData.forEach(row => {
                const tr = document.createElement('tr');

                tr.innerHTML = `
                    <td>
                        <div class="custom-control custom-checkbox checkbox-success check-lg mr-3">
                            <input type="checkbox" class="custom-control-input" id="customCheckBox${row.planilha}" required="">
                            <label class="custom-control-label" for="customCheckBox${row.planilha}"></label>
                        </div>
                    </td>
                    <td><strong>${row.planilha}</strong></td>
                    <td>${row.nfe}</td>
                    <td>${moment(row.emissao).format('DD/MM/YYYY')}</td>
                    <td>${row.cnpj}</td>
                    <td>${row.chave}</td>
                    <td><span class="badge badge-success">${row.status}</span></td>
                    <td><button class="btn btn-outline-primary btn-sm">XML</button></td>
                    <td><button class="btn btn-outline-primary btn-sm">PDF</button></td>
                `;

                tableBody.appendChild(tr);
            });
        }

        document.getElementById('filter-form3').addEventListener('submit', function (e) {
            e.preventDefault();

            const de = document.getElementById('de').value;
            const ate = document.getElementById('ate').value;
            const nro = document.getElementById('nro').value;
            const nfe = document.getElementById('nfe').value;
            const chave = document.getElementById('chave').value;

            const filteredData = data.filter(row => {
                const emissaoDate = moment(row.emissao);
                const fromDate = de ? moment(de) : null;
                const toDate = ate ? moment(ate) : null;

                return (!fromDate || emissaoDate.isSameOrAfter(fromDate, 'day')) &&
                    (!toDate || emissaoDate.isSameOrBefore(toDate, 'day')) &&
                    (!nro || row.planilha.includes(nro)) &&
                    (!nfe || row.nfe.includes(nfe)) &&
                    (!chave || row.chave.includes(chave));
            });

            renderTable(filteredData);
        });

        // Render initial table
        renderTable(data);
    </script>
</body>

</html>
